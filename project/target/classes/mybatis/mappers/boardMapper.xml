<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 다른 mapper와 중복되지 않도록 네임스페이스 기재 -->
<mapper namespace="com.example.project.board.service.impl.BoardMapper">
	
	<select id="selectBoardList" parameterType="BoardVO" resultType="BoardVO">
		 SELECT BOARD_ID
		       ,BOARD_TITLE
		       ,BOARD_CONTENT
		       ,BOARD_TYPE
		       ,BOARD_DATE
		       ,USER_ID
		  FROM T_BOARD
		  <where>
		  	<if test="currentPage != null and currentPage != 0">
		  		AND BOARD_ID BETWEEN 1 + (#{currentPage} - 1) * 10 AND #{currentPage} * 10
		  	</if>
		  	<if test="boardId != null and boardId != 0">
		  			AND BOARD_ID = #{boardId}
		  	</if>
		  </where>
	</select>
	
	<select id="countBoardList" resultType="PagingVO">
		SELECT COUNT(BOARD_ID) BOARD_COUNT
  		  FROM T_BOARD
	</select>
	
	<insert id="insertBoardList" parameterType="BoardVO">
		INSERT INTO T_BOARD (BOARD_ID, BOARD_TITLE, BOARD_CONTENT, BOARD_TYPE, BOARD_DATE, USER_ID)
             VALUES((SELECT NVL2(MAX(BOARD_ID), (MAX(BOARD_ID) + 1), 1) 
                       FROM T_BOARD),
                     #{boardTitle}, #{boardContent}, #{boardType}, #{boardDate}, #{userId})
        
	</insert>
	
	<update id="updateBoardList" parameterType="BoardVO">
		UPDATE T_BOARD 
		   SET BOARD_TITLE = #{boardTitle}
		      ,BOARD_CONTENT = #{boardContent}
		      ,BOARD_TYPE = #{boardType}
		      ,BOARD_DATE = #{boardDate}
		WHERE BOARD_ID = #{boardId}
		           
	</update>
	
	<delete id="deleteBoardList" parameterType="BoardVO">
		DELETE FROM T_BOARD
         WHERE BOARD_ID = #{boardId}
	</delete>
	
	
	<select id="selectReplyList" parameterType="BoardReplyVO" resultType="BoardReplyVO">
		 SELECT REPLY_ID
		       ,REPLY_CONTENT
		       ,REPLY_DATE
		       ,BOARD_ID
		       ,USER_ID
		   FROM T_REPLY
		   <where>
			   <if test="boardId != null and boardId = 0">
			   		AND BOARD_ID = #{boardId}
			   </if>
		   </where>
	</select>
	
	<insert id="insertReplyList" parameterType="BoardReplyVO">
		INSERT INTO T_REPLY (REPLY_CONTENT, BOARD_ID, USER_ID)
        			VALUES (#{replyContent}, #{boardId}, #{userId})
	</insert>
	
	<update id="updateReplyList" parameterType="BoardReplyVO">
		 UPDATE T_REPLY
			SET REPLY_CONTENT = #{replyContent}
			WHERE BOARD_ID = #{replyId}
	</update>
	
	<delete id="deleterReplyList" parameterType="BoardReplyVO">
		DELETE T_REPLY
		<where>
			<if test="boardId != null and boardId != 0">
				AND WHERE BOARD_ID = #{boardId}
			</if>
			<if test="replyId != null and replyId != 0">
				AND WHERE BOARD_ID = #{boardId}
			</if>
		</where>
		 
	</delete>



	

</mapper>














